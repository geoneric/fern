test_data_dir="${PROJECT_SOURCE_DIR}/data/tests"
fern_test_dir="${CMAKE_CURRENT_BINARY_DIR}/sources/fern"
cmake="${CMAKE_COMMAND}"


echo "write(-9.8, \"$fern_test_dir/constant-1.gnr:earth/gravity\", \
    \"Geoneric\")" | fern execute -



# io_ogr_test_dir="$fern_test_dir/io/ogr/test"
# $cmake -E copy $test_data_dir/point.json $io_ogr_test_dir
# 
# $cmake -E copy $test_data_dir/point.json $io_ogr_test_dir/read_only_point.json
# chmod 444 $io_ogr_test_dir/read_only_point.json
# 
# $cmake -E copy $test_data_dir/point.json $io_ogr_test_dir/write_only_point.json
# chmod 222 $io_ogr_test_dir/write_only_point.json
# 
# $cmake -E copy $test_data_dir/point.json $io_ogr_test_dir/execute_only_point.json
# chmod 111 $io_ogr_test_dir/execute_only_point.json
# 
# $cmake -E make_directory $io_ogr_test_dir/read_only_dir
# chmod 666 $io_ogr_test_dir/read_only_dir


io_core_test_dir="$fern_test_dir/io/core/test"
$cmake -E copy $test_data_dir/raster-1.asc $io_core_test_dir
$cmake -E copy $test_data_dir/raster-1.asc $io_core_test_dir/write_only.asc
chmod 222 $io_core_test_dir/write_only.asc
rm -f $io_core_test_dir/raster-1-link.asc
ln -s raster-1.asc $io_core_test_dir/raster-1-link.asc
rm -f $io_core_test_dir/raster-1-dangling_link.asc
ln -s does_not_exist.asc $io_core_test_dir/raster-1-dangling_link.asc


io_gdal_test_dir="$fern_test_dir/io/gdal/test"
$cmake -E copy $test_data_dir/raster-1.asc $io_gdal_test_dir
$cmake -E copy $test_data_dir/raster-2.asc $io_gdal_test_dir
# $cmake -E copy $test_data_dir/raster-1.asc $io_gdal_test_dir/write_only.asc
# chmod 222 $io_gdal_test_dir/write_only.asc


io_fern_test_dir="$fern_test_dir/io/fern/test"
$cmake -E copy $fern_test_dir/constant-1.gnr $io_fern_test_dir
# $cmake -E copy $io_fern_test_dir/constant-1.gnr \
#     $io_fern_test_dir/write_only.gnr
# chmod 222 $io_fern_test_dir/write_only.gnr


io_test_dir="$fern_test_dir/io/test"
$cmake -E copy $test_data_dir/raster-1.asc $io_test_dir
$cmake -E copy $fern_test_dir/constant-1.gnr $io_test_dir
$cmake -E copy $io_test_dir/constant-1.gnr $io_test_dir/write_only.gnr
chmod 222 $io_test_dir/write_only.gnr


interpreter_test_dir="$fern_test_dir/interpreter/test"
$cmake -E copy $test_data_dir/valid-1.ran $interpreter_test_dir
$cmake -E copy $test_data_dir/valid-2.ran $interpreter_test_dir
$cmake -E copy $test_data_dir/invalid-1.ran $interpreter_test_dir
$cmake -E copy $test_data_dir/valid-1.ran $interpreter_test_dir/valid-1_unreadable.ran
chmod a-r $interpreter_test_dir/valid-1_unreadable.ran
$cmake -E copy $test_data_dir/raster-1.asc $interpreter_test_dir
$cmake -E copy $fern_test_dir/constant-1.gnr $interpreter_test_dir
